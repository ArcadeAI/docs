# Outlook Mail

import ToolInfo from "@/components/ToolInfo";
import Badges from "@/components/Badges";
import TabbedCodeBlock from "@/components/TabbedCodeBlock";
import TableOfContents from "@/components/TableOfContents";

<ToolInfo
  description="Enable agents to read, write, and send emails with Outlook."
  author="Arcade"
  codeLink="https://github.com/ArcadeAI/arcade-ai/tree/main/toolkits/microsoft"
  authType="oauth2"
  authProviderName="Microsoft"
  versions={["0.1.0"]}
/>

<Badges repo="arcadeai/arcade_microsoft" />

The Arcade Outlook Mail toolkit provides pre-built tools for working with emails using the Outlook API. Use these tools to:

- Read emails
- Write emails
- Send emails

## Install

```bash
pip install arcade_microsoft
```

<Note>
  pip installing the toolkit is only needed if you are [self-hosting](/home/install/overview) Arcade. You do not need to install the toolkit if you're using Arcade Cloud.
</Note>

## Available Tools

These tools are currently available in the Arcade Sheets toolkit.

<TableOfContents
  headers={["Tool Name", "Description"]}
  data={[
    ["CreateDraftEmail", "Compose a new draft email in Outlook"],
    ["UpdateDraftEmail", "Update an existing draft email in Outlook"],
    ["SendDraftEmail", "Send an existing draft email in Outlook"],
    ["CreateAndSendEmail", "Create and immediately send a new email in Outlook to the specified recipients"],
    ["ReplyToEmail", "Reply only to the sender of an existing email in Outlook."],
    ["ReplyAllToEmail", "Reply to all recipients of an existing email in Outlook."],
    ["ListEmails", "List emails in the user's mailbox across all folders."],
    ["ListEmailsInFolder", "List the user's emails in the specified folder."],
  ]}
/>

<Tip>
  If you need to perform an action that's not listed here, you can [get in touch
  with us](mailto:contact@arcade.dev) to request a new tool, or [create your
  own tools](/home/build-tools/create-a-toolkit) with the [Google auth
  provider](/home/auth-providers/google#using-google-auth-in-custom-tools).
</Tip>

## CreateDraftEmail

Compose a new draft email in Outlook.

**Parameters**

- **`subject`** _(string, required)_: The subject of the email to create.
- **`body`** _(string, required)_: The body of the email to create.
- **`to_recipients`** _(list of strings, required)_: The email addresses that will be the recipients of the draft email.
- **`cc_recipients`** _(list of strings, optional)_: The email addresses that will be the CC recipients of the draft email.
- **`bcc_recipients`** _(list of strings, optional)_: The email addresses that will be the BCC recipients of the draft email.

<br />
<TabbedCodeBlock
  tabs={[
    {
      label: "Call the Tool with User Authorization",
      content: {
        Python: [
          "/examples/integrations/toolkits/microsoft/outlook_mail/create_draft_email_example_call_tool.py",
        ],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/create_draft_email_example_call_tool.js"],
      },
    },
    {
      label: "Execute the Tool with OpenAI",
      content: {
        Python: [
          "/examples/integrations/toolkits/microsoft/outlook_mail/create_draft_email_example_llm_oai.py",
        ],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/create_draft_email_example_llm_oai.js"],
      },
    },
  ]}
/>

---

## UpdateDraftEmail

Update an existing draft email in Outlook.

This tool overwrites the subject and body of a draft email (if provided),
and modifies its recipient lists by selectively adding or removing email addresses.

This tool can update any un-sent email:
    - draft
    - reply-draft
    - reply-all draft
    - forward draft

**Parameters**

- **`message_id`** _(string, required)_: The ID of the draft email to update.
- **`subject`** _(string, optional)_: The new subject of the draft email. If provided, the existing subject will be overwritten.
- **`body`** _(string, optional)_: The new body of the draft email. If provided, the existing body will be overwritten
- **`to_add`** _(list of strings, optional)_: Email addresses to add as 'To' recipients.
- **`to_remove`** _(list of strings, optional)_: Email addresses to remove from the current 'To' recipients.
- **`cc_add`** _(list of strings, optional)_: Email addresses to add as 'CC' recipients.
- **`cc_remove`** _(list of strings, optional)_: Email addresses to remove from the current 'CC' recipients.
- **`bcc_add`** _(list of strings, optional)_: Email addresses to add as 'BCC' recipients.
- **`bcc_remove`** _(list of strings, optional)_: Email addresses to remove from the current 'BCC' recipients.
<br />
<TabbedCodeBlock
  tabs={[
    {
      label: "Call the Tool with User Authorization",
      content: {
        Python: [
          "/examples/integrations/toolkits/microsoft/outlook_mail/update_draft_email_example_call_tool.py",
        ],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/update_draft_email_example_call_tool.js"],
      },
    },
    {
      label: "Execute the Tool with OpenAI",
      content: {
        Python: [
          "/examples/integrations/toolkits/microsoft/outlook_mail/update_draft_email_example_llm_oai.py",
        ],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/update_draft_email_example_llm_oai.js"],
      },
    },
  ]}
/>

---

## SendDraftEmail

Send an existing draft email in Outlook

    This tool can send any un-sent email:
        - draft
        - reply-draft
        - reply-all draft
        - forward draft

**Parameters**

- **`message_id`** (string, required): The ID of the draft email to send

<TabbedCodeBlock
  tabs={[
    {
      label: "Call the tool with user authorization",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/send_draft_email_example_call_tool.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/send_draft_email_example_call_tool.js"]
      }
    },
    {
      label: "Execute the tool with OpenAI",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/send_draft_email_example_llm_oai.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/send_draft_email_example_llm_oai.js"]
      }
    }
  ]}
/>

---

## CreateAndSendEmail

Create and immediately send a new email in Outlook to the specified recipients

**Parameters**

- **`subject`** (string, required): The subject of the email to create
- **`body`** (string, required): The body of the email to create
- **`to_recipients`** (list[str], required): The email addresses that will be the recipients of the email
- **`cc_recipients`** (list[str], optional): The email addresses that will be the CC recipients of the email.
- **`bcc_recipients`** (list[str], optional): The email addresses that will be the BCC recipients of the email.

<TabbedCodeBlock
  tabs={[
    {
      label: "Call the tool with user authorization",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/create_and_send_email_example_call_tool.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/create_and_send_email_example_call_tool.js"]
      }
    },
    {
      label: "Execute the tool with OpenAI",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/create_and_send_email_example_llm_oai.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/create_and_send_email_example_llm_oai.js"]
      }
    }
  ]}
/>

---

## ReplyToEmail

Reply to an existing email in Outlook.

Use this tool to reply to the sender or all recipients of the email.
Specify the reply_type to determine the scope of the reply.

**Parameters**

- **`message_id`** (string, required): The ID of the email to reply to
- **`body`** (string, required): The body of the reply to the email
- **`reply_type`** (enum ([ReplyType](/toolkits/productivity/microsoft/reference#replytype)), required): Specify "reply" to reply only to the sender or "reply_all" to reply to all recipients.

<TabbedCodeBlock
  tabs={[
    {
      label: "Call the tool with user authorization",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/reply_to_email_example_call_tool.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/reply_to_email_example_call_tool.js"]
      }
    },
    {
      label: "Execute the tool with OpenAI",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/reply_to_email_example_llm_oai.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/reply_to_email_example_llm_oai.js"]
      }
    }
  ]}
/>

---

## ListEmails

List emails in the user's mailbox across all folders.

Since this tool lists email across all folders, it may return sent items, drafts,
and other items that are not in the inbox.

**Parameters**

- **`limit`** (int, optional): The number of messages to return. Max is 100. Defaults to 5.
- **`pagination_token`** (str, optional): The pagination token to continue a previous request

<TabbedCodeBlock
  tabs={[
    {
      label: "Call the tool with user authorization",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_example_call_tool.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_example_call_tool.js"]
      }
    },
    {
      label: "Execute the tool with OpenAI",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_example_llm_oai.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_example_llm_oai.js"]
      }
    }
  ]}
/>

---

## ListEmailsInFolder

List the user's emails in the specified folder.

Exactly one of `well_known_folder_name` or `folder_id` MUST be provided.

**Parameters**

- **`well_known_folder_name`** (enum ([WellKnownFolderNames](/toolkits/productivity/microsoft/reference#wellknownfoldernames)), optional): The name of the folder to list emails from. Defaults to None.
- **`folder_id`** (str, optional): The ID of the folder to list emails from if the folder is not a well-known folder. Defaults to None.
- **`limit`** (int, optional): The number of messages to return. Max is 100. Defaults to 5.
- **`pagination_token`** (str, optional): The pagination token to continue a previous request

<TabbedCodeBlock
  tabs={[
    {
      label: "Call the tool with user authorization",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_in_folder_example_call_tool.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_in_folder_example_call_tool.js"]
      }
    },
    {
      label: "Execute the tool with OpenAI",
      content: {
        Python: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_in_folder_example_llm_oai.py"],
        JavaScript: ["/examples/integrations/toolkits/microsoft/outlook_mail/list_emails_in_folder_example_llm_oai.js"]
      }
    }
  ]}
/>

---

## Auth

The Arcade Outlook Mail toolkit uses the [Microsoft auth provider](/home/auth-providers/microsoft) to connect to users' Microsoft accounts.

With the hosted Arcade Engine, there's nothing to configure. Your users will see `Arcade` as the name of the application that's requesting permission.

With a self-hosted installation of Arcade, you need to [configure the Microsoft auth provider](/home/auth-providers/microsoft#configuring-microsoft-auth) with your own Microsoft app credentials.

---

## Reference

### WellKnownFolderNames

Well-known folder names that are created for users by default.
Instead of using the ID of these folders, you can use the well-known folder names.

- **`DELETED_ITEMS`** _(string: "deleteditems")_
- **`DRAFTS`** _(string: "drafts")_
- **`INBOX`** _(string: "inbox")_
- **`JUNK_EMAIL`** _(string: "junkemail")_
- **`SENT_ITEMS`** _(string: "sentitems")_
- **`STARRED`** _(string: "starred")_
- **`TODO`** _(string: "tasks")_

### ReplyType

The type of reply to send to an email.

- **`REPLY`** _(string: "reply")_
- **`REPLY_ALL`** _(string: "reply_all")_
