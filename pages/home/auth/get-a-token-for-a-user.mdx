---
title: "Get a token in an agent"
description: "Guide on how to authorize agents in Arcade"
---

import { Steps, Tabs } from "nextra/components";

# Generic Agent Authorization

In this guide, you'll learn how to use Arcade to obtain user authorization for accessing third-party services, without using Arcade for tool execution or definition. We'll use Google's Gmail API as an example to demonstrate how to:

- Get authorization tokens through Arcade
- Handle user authentication flows
- Use tokens with external services

This can be useful when you need to manage authorization flows in your application.

<Steps>

### Prerequisites

- [Set up Arcade](/home/quickstart)
- Install the Arcade Client and the required libraries:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```bash
pip install arcadepy google-api-python-client google-auth-httplib2 google-auth-oauthlib
```
</Tabs.Tab>
<Tabs.Tab>
```bash
npm install @arcadeai/arcadejs googleapis
```
</Tabs.Tab>
</Tabs>

### Import required libraries

First, let's import all the libraries we'll need:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```python file=<rootDir>/examples/code/guides/agentauth/auth_with_google.py#L1-L3

```
</Tabs.Tab>
<Tabs.Tab>
```javascript file=<rootDir>/examples/code/guides/agentauth/auth_with_google.js#L1-L2

```
</Tabs.Tab>
</Tabs>

### Initialize the Arcade client

Create an instance of the Arcade client:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```python file=<rootDir>/examples/code/guides/agentauth/auth_with_google.py#L5

```
</Tabs.Tab>
<Tabs.Tab>
```javascript file=<rootDir>/examples/code/guides/agentauth/auth_with_google.js#L14

```
</Tabs.Tab>
</Tabs>

### Initiate an authorization request

Use `client.auth.start` to initiate the authorization process:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```python file=<rootDir>/examples/code/guides/agentauth/auth_with_google.py#L17-L25

```
</Tabs.Tab>
<Tabs.Tab>
```javascript file=<rootDir>/examples/code/guides/agentauth/auth_with_google.js#L16-L22

```
</Tabs.Tab>
</Tabs>

### Guide the user through authorization

If authorization is not completed, prompt the user to visit the authorization URL:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```python file=<rootDir>/examples/code/guides/agentauth/auth_with_google.py#L27-L29

```
</Tabs.Tab>
<Tabs.Tab>
```javascript file=<rootDir>/examples/code/guides/agentauth/auth_with_google.js#L24-L27

```
</Tabs.Tab>
</Tabs>

### Wait for the user to authorize the request

Use `wait_for_completion()` to wait for the user to authorize the request:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```python file=<rootDir>/examples/code/guides/agentauth/auth_with_google.py#L32

```
</Tabs.Tab>
<Tabs.Tab>
```javascript file=<rootDir>/examples/code/guides/agentauth/auth_with_google.js#L30

```
</Tabs.Tab>
</Tabs>

### Use the obtained token

Once authorization is complete, you can use the obtained token to access the third-party service:

<Tabs items={["Python", "JavaScript"]}>
<Tabs.Tab>
```python file=<rootDir>/examples/code/guides/agentauth/auth_with_google.py#L37-L44

```
</Tabs.Tab>
<Tabs.Tab>
```javascript file=<rootDir>/examples/code/guides/agentauth/auth_with_google.js#L36-L47

```
</Tabs.Tab>
</Tabs>

</Steps>

<Note>
  Consider using the [Arcade Google toolkit](/toolkits/productivity/google/gmail), which simplifies the process for retrieving email messages even further! The pattern described here is useful if you need to directly get a token to use with Google in other parts of your codebase.
</Note>

### How it works

By using `client.auth.start` and `client.auth.wait_for_completion`, you leverage Arcade to manage the OAuth flow for user authorization.

Arcade handles the authorization challenges and tokens, simplifying the process for you.

### Next steps

Integrate this authorization flow into your application, and explore how you can manage different providers and scopes.