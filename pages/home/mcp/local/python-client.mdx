import { Steps, Tabs } from "nextra/components";
import { SignupLink } from "@/components/Analytics";

# MCP Local Python Client

In this guide, you'll learn how to create a Python client that can connect to a local MCP server.

<Steps>

### Prerequisites

1. Create an <SignupLink utmParams={{
            utm_source: "docs",
            utm_medium: "page",
            utm_campaign: "claude-desktop-client",
          }} linkLocation="docs:claude-desktop-client">Arcade account</SignupLink>
2. Get an [Arcade API key](/home/api-keys)

### Install Dependencies

```bash
pip install mcp
pip install arcade-ai
pip install arcade-google
```
<Tip>
See [Arcade's Integrations](/toolkits) for more toolkits that can be installed.
</Tip>

### Write your MCP Client

```python
import asyncio

from mcp import ClientSession, StdioServerParameters
from mcp.client.stdio import stdio_client


async def main():
    # Define the command to start the MCP server
    ARCADE_API_KEY = "YOUR_ARCADE_API_KEY_HERE" # Replace with your actual Arcade API key
    PATH_TO_PYTHON = "/path/to/python" # Replace with the path to your Python interpreter
    PATH_TO_ARCADE = "/path/to/arcade" # Replace with the path to the Arcade package
    server_params = StdioServerParameters(
        command="bash",
        args=[
            "-c",
            f"export ARCADE_API_KEY={ARCADE_API_KEY} && {PATH_TO_PYTHON} {PATH_TO_ARCADE} serve --mcp",
        ],
    )

    # Establish a connection to the MCP server using stdio transport
    async with stdio_client(server_params) as streams, ClientSession(*streams) as session:
        # Initialize the session with the server
        await session.initialize()

        # Retrieve the list of available tools from the server
        response = await session.list_tools()

        # Display available tools
        print("Available tools:")
        for tool in response.tools:
            first_line_of_description = tool.description.split("\n")[0]
            print(f"  - {tool.name} ({first_line_of_description})")

        # Call a tool
        response = await session.call_tool(
            name="Google_ListEmails",
            arguments={"limit": 5},
        )

        # Handle the case where the tool returns a URL for authorization
        if response.content[0].type == "text" and response.content[0].text.startswith("https://"):
            print(f"Please go to this URL and authorize the action: {response.content[0].text}")
            input("After completing the authorization flow, press Enter to continue...")
            response = await session.call_tool(
                name="Google_ListEmails",
                arguments={"limit": 5},
            )

        print(response.content[0].text)


# Execute the main function
asyncio.run(main())
```

</Steps>
